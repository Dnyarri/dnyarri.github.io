<!doctype html>
<html lang='en-US'>
<head>
    <link rel="icon" href="vaba.svg" type="image/svg+xml">
    <link rev='made' href='mailto:ilyarazmanov@gmail.com'>
    <link rel='canonical' href='https://dnyarri.github.io/batch.html'/>
    <meta charset='utf-8' />
    <meta name='author' content='Ilyich the Toad'>
    <meta name='description' content='Python scripts for automated batch processing of documents (LibreOffice), audio (ffmpeg and optivorbis), files and filesystem compression (compact.exe), as well as reverse file name transliteration etc.'>
    <meta name='keywords' content='Python, compression, conversion, LibreOffice, ffmpeg, optivorbis'>
    <link rel='stylesheet' href='toc.css' type='text/css'>
    <link rel='stylesheet' href='content.css' type='text/css'>
    <title>Python scripts for batch processing</title>
</head>
<body>
    <div class='leftarea'> <!-- Nav holder begin -->
        <object data='toc.html' class='leftbar'></object>
    </div>
    <div class='content'> <!-- Content block begin -->
    <h1 class='darkbg'>Batch processing</h1>
    <h2 class='lightbg'>Useful Python scripts for every day</h2>
    <div class='lightbg justborder'>
        <p>Repository includes various Python scripts for batch processing. Total number of files varies over time. Most suitable seem to be:</p>
        <p>
        <ul class='dark'>
            <li><b>dir LibreOffice rtf2docx</b> - batch convertion of .rtf, .doc, .odt and .fb2 files to .docx using <a href='https://www.libreoffice.org/'>LibreOffice</a>. Overcomes clumsy LibreOffice ideas like starting several instances, or exporting all files into one dir, or something. Surely may be modified for batch conversion of not only rtf to docx (that was it's initial purpose) but also anything LibreOffice can read into anything it can write, like doc to PDF etc.</li>
            <li><b>dir ffmpeg flac2ogg 48</b> - converts all .flac within dir and subdirs to .ogg 48&nbsp;kHz, using <a href='https://github.com/BtbN/FFmpeg-Builds/'>FFMPEG</a>; removes junk like preview and &laquo;Zdes' byl Vasya&raquo; comments.</li>
            <li><b>dir ffmpeg flac2ogg 44</b> - converts all .flac within dir and subdirs to 16-bit 44.1&nbsp;kHz (CD quality) .ogg, using <a href='https://github.com/BtbN/FFmpeg-Builds/'>FFMPEG</a>; removes junk.</li>
            <li><b>dir OPTIVORBIS ogg</b> - recompress all .ogg files within dir and subdirs, using <a href='https://github.com/OptiVorbis/OptiVorbis/'>OPTIVORBIS</a>; saves up to 10&nbsp;%  of .ogg size after ffmpeg.</li>
            <li><b>dir COMPACT LZX</b> - suitable GUI to Microsoft compact.exe, allowing to compress dir and subdirs using LZX compression (supported since Windows&nbsp;8); modern bloatware typically get compressed 2.5-2.7&nbsp;:&nbsp;1, sometimes 3&nbsp;:&nbsp;1. Well, actually it's an example of redirecting compact.exe console output via subprocess <i>Popen</i> pipe to Tkinter <i>ScrolledText</i> ;-)</li>
            <li><b>dir AdvZIP docx</b> - recompressing .docx after dir LibreOffice rtf2docx gives up to 7&nbsp;%  space saving.</li>
            <li lang='ru-Cyrl'><b>dir RENAME untranslit</b> - intended <b>for Russian users</b>. Программа для оптового переименования (batch renaming) файлов с латиницы на русский (кириллицу). Не соответствует ISO&nbsp;9, поскольку ISO&nbsp;9 всё равно никто не использует, кроме как на федеральной службе; словари переименования составлены на основе того, с чем я лично сталкиваюсь, и периодически пополняются после новых столкновений. Словари (их три, средний для дифтонгов, предыдущий для более заковыристых, последний для отдельных букв) далеки от идеала (например, не умеют вставлять мягкие знаки после согласных там, где нужно), так что смело редактируйте, и не забывайте поделиться полезными комбинациями. И да, нет, не всё - <span class='red'><b>будьте крайне осторожны</b></span>, не направляйте эту программу на директории типа Windows или Program&nbsp;Files. Всё она, конечно, не переименует, но многое успеет...</li>
            <li><b>dir RENAME unflibusta</b> - batch renaming of files according to patterns, like replacing underscores with spaces, removing digits, and so on. Edit rules pattern to your need.</li>
        </ul>
        </p>
        <p>Note that programs <i>dir&nbsp;COMPACT LZX</i>, <i>dir&nbsp;OPTIVORBIS&nbsp;ogg</i>, <i>dir&nbsp;ffmpeg&nbsp;flac2ogg&nbsp;48</i> and <i>dir&nbsp;ffmpeg&nbsp;flac2ogg&nbsp;44</i> accept command line arguments at start time. Argument is supposed to be a name of folder; in this case program GUI opens right in this folder. If argument happen to be a file, GUI will be opened in folder containing it. You may use it for creating shortcuts like:</p>
        <pre>    pythonw.exe "dir COMPACT LZX.py.py" "%1"</pre>
        <p>(using actual addresses of Python and script on your system, of course) and then simply drag-and-drop folders onto shortcut to open program right where you need it. If argument is absent (e.g., you just double-click program), program simply opens in default directory and wait for you to browse and point to required location.</p>
        <p>Proceed to <a href='https://github.com/Dnyarri/batchfiles' class='git'>Batchfiles at GitHub</a> for
            downloads.</p>
        <p class='right'>Move back to <a href='https://dnyarri.github.io'>main page</a>.</p>
    </div>
    </div> <!-- Content block end -->
</body>
</html>